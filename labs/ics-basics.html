<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Exercise</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="bg-light">
    <div class="container">
        <h1>Lab 1</h1>
<h2>Scenario Overview</h2>
<p>The industrial control system (ICS) used in this scenario  simulates an environment that might be used to cool industrial equipment. The  ICS is made up of five systems. The first system contains a tank, tank level sensor  and a water pump. The second system is a programmable logic controller (PLC)  which controls the water pump based on the level of water found in the attached  tank. The third system is an Open Platform Communications (OPC) server which accesses  and modifies data found on the PLC. The fourth system is running Human Machine Interface  (HMI) software which communicates with the OPC server to provide a human system  operator with system statistics and control. The final system in the ICS is a security  appliance that provides routing and firewall services for all systems.
This scenario also make use of a system running Kali Linux. In this lab the virtual network switch is configured so that the Kail system receives all data transmitted. (<a href="reference/IndustrialNetworkingBasics-NetworkDiagram.pdf" target="_blank" title="Graphical network diagram">Network diagram</a>)</p>
<p>In this lab the student will use an HMI system to control and configure the ICS in the same way a typical machine operator would. The student will then use an OPC server to control and configure the ICS. Next the student will use the Wireshark network monitoring software to view typical Modbus/TCP traffic generated while the ICS is functioning. The student will then use Metaspolit to verify that the Modbus protocol is highly insecure. Finally, the student will use Wireshark to view some S7 traffic generated by Seimens equipment.</p>

<h3>Part 1</h3>
<p><strong>Install Systems</strong></p>
<p>In this part of the lab you are going to install and configure the systems needed to complete the lab. </p>
<ol>
  <li><input type="checkbox"> If necessary, install the free <a href="https://www.oracle.com/virtualization/technologies/vm/downloads/virtualbox-downloads.html" target="_blank">Oracle VirtualBox Manager</a> software on your system.</li>
  <li><input type="checkbox"> Download, and if necessary extract, the lab image <a href="https://www.nl.northweststate.edu/CAMO/software/VirtualMachine/VirtualBox/ICS-VirtualBox.ova">ICS-VirtualBox.ova</a>.</li>
  <li><input type="checkbox"> Start the <span class="quote">Oracle VM VirtualBox</span> program.</li>
  <li><input type="checkbox"> Import the<span class="quote"> ICS-VirtualBox.ova</span> lab image.</li>
  <li><input type="checkbox"> After the import has completed access the <span class="quote">Settings</span> for the <span class="quote">Security Appliance</span> virtual machine and change its configuration so that it is bridged to the network device in your host computer.</li>
  <li><input type="checkbox"> Power on the systems in the following order:
    <ul>
      <li><strong>Security Appliance</strong>  [Username: <code>admin</code> Password: <code>Password01</code>]</li>
      <li><strong>Sensor</strong> [Username: <code>root</code> Password: <code>Password01</code>]</li>
      <li><strong>PLC</strong> [Username: <code>root</code> Password: <code>Password01</code>]</li>
      <li><strong>OPC</strong> [Username: <code>student</code> Password: <code>Password01</code>]</li>
      <li><strong>HMI</strong> [Username: <code>student</code> Password: <code>Password01</code>]</li>
      <li><strong>Kali</strong> [Username: <code>student</code> Password: <code>Password01</code>]</li>
    </ul>
  </li>
</ol>

<h3>Part 2</h3> 
<p><strong>Use an HMI System to Monitor and Control ICS Components</strong></p>
<p>In this part of the lab you are going to examine the basic functionality of an HMI system.</p>
<ol>
  <li><input type="checkbox"> Access the <span class="quote">HMI</span> system.</li>
  <li><input type="checkbox"> Take a minute to observe the data and controls available in the <span class="quote">AdvancedHMI</span> program.</li>
  <li><input type="checkbox"> Click the <span class="button">Stop</span> button in the <span class="quote">AdvancedHMI</span> program and observe that the system powers down and all activity on the ICS stops.</li>
  <li><input type="checkbox"> Click the <span class="button">Start</span> button in the <span class="quote">AdvancedHMI</span> program and observe that the system powers up and the  ICS again begins to function.</li>
  <li><input type="checkbox"> Click on the value shown in the <span class="quote">Pump on at:</span> field (<a href="../images/Part4-3.png" target="_blank" title="Graphic showing location of screen element">Example</a>).</li>
  <li><input type="checkbox"> Change the pump on value to <span class="typed">10</span> (<a href="../images/Part4-4.png" target="_blank" title="Graphic showing location of screen element">Example</a>).</li>
  <li><input type="checkbox"> Take a minute to observe how this modifies the behavior of the system.</li>
  <li><input type="checkbox"> Click on the value shown in the <span class="quote">Pump off at:</span> field.</li>
  <li><input type="checkbox"> Change the pump off value to <span class="typed">101</span></li>
  <li><input type="checkbox"> Take a minute to observe how this modifies the behavior of the system.</li>
  <li><input type="checkbox"> Take a screen shot showing the results of changing the pump off value to <span class="quote">101</span>, ( <a href="../images/OPC-QuickClient-Written.png" target="_blank" title="Graphic showing location of screen element">Example </a>) then paste it into the lab form found <a href="forms/ics-basics-lab-form.doc">here</a>. </li>
  <li><input type="checkbox"> Click the <span class="button">RESET</span> button in the <span class="quote">AdvancedHMI</span> program, then click the <span class="button">Yes</span> button to indicate that you are sure you want to reset the system.</li>
  <li><input type="checkbox"> Verify that the  ICS is again functional.</li>
</ol>

<h3>Part 3</h3>
<p><strong>Use an OPC Server  to Monitor and Control ICS Components</strong></p>
<p>In this part of the lab you are going to examine the basic functionality of an OPC server.</p>
<ol>
  <li><input type="checkbox"> Access the <span class="quote">OPC</span> system.</li>
  <li><input type="checkbox"> Start the <span class="quote">KEPServerEX 5</span> program by double clicking on the <span class="button">KEPServerEX 5 Configuration</span> icon located in the upper left corner of the desktop.</li>
  <li><input type="checkbox">In the <span class="quote">KEPServerEX 5</span> program, expand the <span class="quote">Modbus TCP/IP Ethernet</span> category ( <a href="../images/OPC-Basic-Access.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Click the <span class="quote">Channel1</span> category and note that the <span class="quote">ID</span> of the <span class="quote">Cooling_Tank</span> PLC is <span class="quote">&lt;10.0.255.102&gt;.0</span> ( <a href="../images/OPC-QuickClient-Cooling_TankAddress.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Expand the <span class="quote">Channel1</span> category ( <a href="../images/OPC-Basic-Access.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Click the <span class="quote">Cooling_Tank</span> category ( <a href="../images/OPC-Basic-Access.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Move your mouse into the space between the <span class="quote">Tag Name</span> and <span class="quote">Address</span> columns until it becomes a resize cursor then drag the boundary to the right until you can view all of the text in the <span class="quote">Tag Name</span> column ( <a href="../images/OPC-Basic-Access.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Notice that the addresses for the listed <span class="quote">Boolean</span> (Bit) values start with a <span class="quote">0</span> which indicates that they are part of the Modus<span class="quote"> Coil</span> table.</li>
  <li><input type="checkbox">Notice that the addresses for the listed <span class="quote">Word</span> values start with a <span class="quote">4</span> which indicates that they are part of the Modus <span class="quote">Holding registers</span> table.</li>
  <li><input type="checkbox">Note that the address of the tag controlling power to the cooling system, the <span class="quote">Power</span> tag, is <span class="quote">000001</span>.</li>
  <li><input type="checkbox">
  In the <span class="quote">KEPServerEX 5</span> program, go to the <span class="quote">Tools</span> menu then choose the <span class="quote">Launch OPC Quick Client </span>link to start the <span class="quote">OPC Quick Client</span> program which will allow you to view real time data.</li>
  <li><input type="checkbox">Maximize the <span class="quote">OPC Quick Client</span> window.</li>
  <li><input type="checkbox">Expand the <span class="quote">Kepware.KEPServerEX.V5</span> category then select the <span class="quote">Channel1.Cooling_Tank</span> folder ( <a href="../images/OPC-QuickClient-Access.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Move your mouse into the space between the <span class="quote">Item ID </span>and <span class="quote">Data Type</span> columns until it becomes a resize cursor then drag the boundary to the right until you can view all of the text in the <span class="quote">Item ID</span> column.</li>
  <li><input type="checkbox">Take a  minute to observe the data shown.</li>
  <li><input type="checkbox">Right click on the <span class="quote">Channel1.Cooling_Tank.Power Item ID</span> then choose the option <span class="quote">Synchronous Write...</span> ( <a href="../images/OPC-QuickClient-Write.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Type <span class="typed">0</span> into the <span class="quote">Write Value</span> field then click the <span class="button">OK</span> button.</li>
  <li><input type="checkbox">Take a screen shot showing the entire <span class="quote">OPC</span> Virtual Machine window and the value of the <span class="quote">Channel1.Cooling_Tank_Power Item ID</span> in the <span class="quote">OPC Quick Client</span> program, ( <a href="../images/OPC-QuickClient-Written.png" target="_blank" title="Graphic showing location of screen element">Example </a>) then paste it into the lab form found <a href="forms/ics-basics-lab-form.doc">here</a>. </li>
  <li><input type="checkbox">Access the <span class="quote">HMI</span> system.</li>
  <li><input type="checkbox">Note that the cooling system has been powered down as a result of the changes made at the <span class="quote">OPC</span> server.</li>
  <li><input type="checkbox">Click the <span class="button">Start</span> button in the <span class="quote">AdvancedHMI</span> program and observe that the system powers up and the  ICS again begins to function.</li>
  <li><input type="checkbox">Access the <span class="quote">OPC</span> system.</li>
  <li><input type="checkbox">Note that the value displayed for the  <span class="quote">Channel1.Cooling_Tank_Power Item ID</span> has changed to a <span class="typed">1</span> as a result of the changes made at the <span class="quote">HMI </span>system.</li>
</ol>

<h3>Part 4</h3>
<p><strong>Use Wireshark to view Modbus/TCP traffic</strong></p>
<p>In this part of the lab you are going to use Wireshark to view Modbus/TCP traffic.</p>
<ol>
  <li><input type="checkbox"> Access the <span class="quote">Kali</span> system.</li>
  <li><input type="checkbox">
  At the login screen enter <span class="typed">student</span> into the <span class="quote">Enter your username</span> field and <span class="typed">Password01</span> into the <span class="quote"> Enter your password</span> field.</li>
  <li><input type="checkbox"> Click the <span class="button">Log In</span> button.</li>
  <li><input type="checkbox"> Open a terminal (command prompt) window by clicking the <span class="typed">Terminal Emulator</span> button found at the upper left hand corner of the window (<a href="../images/Part3-1.png" target="_blank" title="Graphic showing location of screen element">Example</a>).</li>
  <li><input type="checkbox"> Start the Wireshark program by typing the command <span class="typed"> wireshark</span></li>
  <li><input type="checkbox"> After the Wireshark program starts, select the <span class="quote">cell-area-zone</span> network device to indicate that you wish to capture data on that device ( <a href="../images/Wireshark-Select-CellAreaZone.png" target="_blank" title="Graphic showing location of screen element">Example </a>).</li>
  <li><input type="checkbox"> Click the <span class="button">Start Capturing packets </span>button to begin capturing network data (<a href="../images/Part4-BasicWiresharkScreen.png" target="_blank" title="Graphic showing location of screen element"> Example</a> ).</li>
  <li><input type="checkbox"> The data you need to view will be captured very quickly so immediately end the capture by clicking on the <span class="button">Stop Capturing packets </span>button  (<a href="../images/Part4-BasicWiresharkScreen.png" target="_blank" title="Graphic showing location of screen element"> Example </a>). </li>
  <li><input type="checkbox"> View only traffic going to or coming from the OPC server by clicking in the <span class="quote">display filter</span> field, typing <span class="typed">ip.addr==10.0.255.100 </span> then clicking the <span class="button">Apply display filter</span> button or pressing <span class="typed">&lt;ENTER&gt;</span> to activate the filter (<a href="../images/Wireshark-DisplayFilter-OPC.png" target="_blank"> Example</a> ).</li>
  <li><input type="checkbox"> If necessary scroll to the right in the top, <span class="quote">packet list</span> panel, until you are able to view the data shown in the <span class="quote">Info</span> column (<a href="../images/Wireshark-DisplayFilter-OPC.png" target="_blank" title="Graphic showing location of screen element">Example</a>).
    <ul>
      <li> The standard Wireshark output window is divided into three panels, the top panel is named the <span class="quote">packet list</span> panel and contains a summary of each packet captured.</li>
      <li> The middle panel is named the <span class="quote">packet details</span> panel and shows a decoded view of the packet currently selected in the <span class="quote">packet list</span> panel.</li>
      <li> The bottom panel is named the<span class="quote"> packet bytes</span> panel and shows the raw data contained in the packet currently selected in the <span class="quote">packet list</span> panel.</li>
    </ul>
  </li>
  <li><input type="checkbox"> Scroll through the packets in the <span class="quote">packet list</span> panel until you find a packet that is a <span class="quote">Query</span> of type <span class="quote">Read Coils</span> (<a href="../images/Wireshark-DisplayFilter-OPC.png" target="_blank" title="Graphic showing location of screen element">Example</a>).</li>
  <li><input type="checkbox"> In the<span class="quote"> packet list</span> panel select a packet that is a <span class="quote">Query</span> of type <span class="quote">Read Coils</span>.</li>
  <li><input type="checkbox"> In the middle, <span class="quote">packet details</span>, panel expand the <span class="quote">Modbus</span> category of decoded data  (<a href="../images/Wireshark-DisplayFilter-OPC.png" target="_blank" title="Graphic showing location of screen element">Example</a>).</li>
  <li><input type="checkbox"> If necessary scroll down the <span class="quote">packet details</span> panel so that all of the decoded Modbus data is shown.</li>
  <li><input type="checkbox"> Note that the <span class="quote">Reference Number</span>  shown in the <span class="quote">Modbus</span> category is <span class="quote">0</span>, this indicates that the system should read from the <span class="quote">Coil</span> table starting at offset <span class="quote">0</span> which corresponds to the first <span class="quote">Coil</span> in the <span class="quote">Coil</span> table.
    <ul>
      <li>The Modbus <span class="quote">Coil</span> table is used to store read/write binary data.</li>
      <li>The first <span class="quote">Coil</span> in the <span class="quote">Coil</span> table has the address <span class="quote">000001</span> which, as was observed when the OPC server was being examined, represents the Power tag which monitors and controls the status of power going to the cooling system.</li>
    </ul>
  </li>
  <li><input type="checkbox"> Note that the <span class="quote">Bit Count</span> is <span class="quote">5</span>, this indicates that the request should read 5 bits (Coils) of data.</li>
  <li><input type="checkbox"> In the <span class="quote">packet list</span> panel select a packet that is a <span class="quote">Response</span> of type <span class="quote">Read Coils</span>.</li>
  <li><input type="checkbox"> If necessary, expand the  <span class="quote">Modbus</span> category of detail data then scroll down  so that all of the decoded Modbus data is shown ( <a href="../images/Wireshark-Modbus-CoilRead.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> Note that the value of <span class="quote">Bit 0</span>, which represents the <span class="quote">Coil</span> with the address of <span class="quote">000001 (Power)</span>, is currently set to <span class="quote">1</span> indicating that the system is powered on.</li>
  <li><input type="checkbox"> Access the <span class="quote">HMI</span> system.</li>
  <li><input type="checkbox"> Click the <span class="button">Stop</span> button in the <span class="quote">AdvancedHMI</span> program and observe that the all activity on the ICS stops.</li>
  <li><input type="checkbox"> Return to  the <span class="quote">Kali</span> system.</li>
  <li><input type="checkbox"> Click the <span class="button">Start Capturing packets </span>button to begin capturing network data.</li>
  <li><input type="checkbox"> Click the <span class="button">Continue without Saving</span> button when you are informed that there are unsaved packets in the program.</li>
  <li><input type="checkbox"> The data you need to view will be captured very quickly so immediately end the capture by clicking on the <span class="button">Stop Capturing packets </span>button. </li>
  <li><input type="checkbox"> Scroll through the packets in the <span class="quote">packet list</span> panel until you find a packet that is a <span class="quote">Response</span> of type <span class="quote">Read Coils</span>.</li>
  <li><input type="checkbox"> If necessary, expand the <span class="quote">Modbus</span> category of detail data then scroll down to view the values of the bits (Coils) retrieved from the PLC ( <a href="../images/Wireshark-Modbus-CoilRead.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> Note that the value of <span class="quote">Bit 0</span>, which represents the <span class="quote">Coil</span> with the address of <span class="quote">000001 (Power)</span>, is currently set to <span class="quote">0</span> indicating that the system is powered off.</li>
  <li><input type="checkbox"> Take a screen shot that shows the entire Kali window ( <a href="../images/Wireshark-Modbus-CoilRead-PowerOff.png" target="_blank" title="Graphic showing location of screen element">Example </a>) then paste it into the lab form found <a href="forms/ics-basics-lab-form.doc">here</a>. </li>
  <li><input type="checkbox"> Close the <span class="quote">Wireshark</span> program clicking the <span class="button">Quit without Saving</span> button when prompted.</li>
  <li><input type="checkbox"> Access the <span class="quote">HMI</span> system.</li>
  <li><input type="checkbox"> Click the <span class="button">Start</span> button in the <span class="quote">AdvancedHMI</span> program and observe that the  ICS again begins to function.</li>
</ol>

<h3>Part 5</h3> 
<p><strong>Use Metasploit to exploit Modbus/TCP vulnerabilities</strong></p>
<p>In this part of the lab, you will use the Metasploit program on the Kali system to exploit Modbus/TCP's lack of authentication or authorization controls.</p>
<ol>
  <li><input type="checkbox"> Access the <span class="quote">Kali</span> system.</li>
  <li><input type="checkbox"> Access a terminal window on the <span class="quote">Kali</span> system.</li>
  <li><input type="checkbox"> Type the <span class="typed">msfconsole</span> command to start the <span class="quote">Metasploit</span> program.</li>
  <li><input type="checkbox"> After the <span class="quote">Metasploit</span> program starts type the command <span class="typed">search modbus</span> to display the <span class="quote">Metasploit</span> modules that specifically target systems using the <span class="quote">Modbus</span> protocol.</li>
  <li><input type="checkbox"> Type the command <span class="typed">use auxiliary/scanner/scada/modbusclient</span> to load the <span class="quote">Modbus Client Utility</span> module ( <a href="../images/Metasploit-Modbus-LoadModule.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> Type the command <span class="typed">show options</span> to view the options available in the <span class="quote">Modbus Client Utility</span> module ( <a href="../images/Metasploit-Modbus-CoilRead.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> Type the command <span class="typed">set rhosts 10.0.255.102</span> to indicate that you want the module to connect with the PLC ( <a href="../images/Metasploit-Modbus-CoilRead.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> Type the command <span class="typed">set action READ_COILS</span> to indicate that you want to read from the <span class="quote">Coil</span> table on the PLC ( <a href="../images/Metasploit-Modbus-CoilRead.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox">Type the command <span class="typed">set data_address 0</span> to indicate you want to read from the <span class="quote">Coil</span> table starting at offset <span class="quote">0</span> ( <a href="../images/Metasploit-Modbus-CoilRead.png" target="_blank">Example</a> ).
    <ul>
      <li>The address of the Coil with an offset of 0 is <span class="quote">000001</span> which, as was observed when the OPC server was being examined, represents the Power tag which monitors and controls the status of power going to the cooling system.</li>
    </ul>
  </li>
  <li><input type="checkbox"> Type the command <span class="typed">exploit</span> to execute the <span class="quote">Modbus Client Utility</span> module with the options set.</li>
  <li><input type="checkbox"> Note that the value of the data found at offset 0 of the  <span class="quote">Coil</span> table is currently set to <span class="quote">1</span> indicating that the system is powered on.</li>
  <li><input type="checkbox"> Type the command <span class="typed">set action WRITE_COIL</span> to indicate that you want to write a single value into the <span class="quote">Coil</span> table on the PLC.</li>
  <li><input type="checkbox"> Type the command <span class="typed">set data 0 </span> to indicate that you want to change the value at offset 0 of the Coil table to a 0.</li>
  <li><input type="checkbox"> Type the command <span class="typed">exploit</span> to execute the <span class="quote">Modbus Client Utility</span> module with the options set.</li>
  <li><input type="checkbox"> Take a screen shot that shows the entire Kali window ( <a href="../images/Metasploit-Modbus-CoilWrite.png" target="_blank" title="Graphic showing location of screen element">Example </a>) then paste it into the lab form found <a href="forms/ics-basics-lab-form.doc">here</a>. </li>
  <li><input type="checkbox"> Access the <span class="quote">HMI</span> system.</li>
  <li><input type="checkbox"> Note that the cooling system has been powered down as a result of the changes made using the Metasploit program.</li>
  <li><input type="checkbox"> Access the <span class="quote">Kali</span> system.</li>
  <li><input type="checkbox"> Type the command <span class="typed">exit</span> to end the Metasploit program.</li>
</ol>

<h3>Part 6</h3>
<p><strong>Use Wireshark to view Siemens S7 traffic</strong></p>
<p>In this part of the lab you are going to use Wireshark to view Siemens S7 traffic.</p>
<ol>
  <li><input type="checkbox"> Access a terminal window on the <span class="quote">Kali</span> system.</li>
  <li><input type="checkbox"> Start the <span class="quote">Wireshark</span> program by typing the command <span class="typed"> wireshark</span></li>
  <li><input type="checkbox"> From the <span class="quote">File</span> menu in <span class="quote">Wireshark</span> choose the <span class="quote">Open</span> option.</li>
  <li><input type="checkbox"> Navigate to the <span class="quote">/home/student/labs/ics-basics</span> directory then open the <span class="quote">snap7.pcapng</span> capture file.</li>
  <li><input type="checkbox"> View only traffic going to or coming from the OPC server by clicking in the <span class="quote">display filter</span> field, typing <span class="typed">ip.addr==10.0.255.100 </span> then clicking the <span class="button">Apply display filter</span> button or pressing <span class="typed">&lt;ENTER&gt;</span> to activate the filter (<a href="../images/S7-Basics1.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> If necessary scroll to the right in the top, <span class="quote">packet list</span> panel, until you are able to view the data shown in the <span class="quote">Info</span> column ( <a href="../images/S7-Basics1.png" target="_blank" title="Graphic showing location of screen element">Example</a> ).  </li>
  <li><input type="checkbox"> Scroll through the packets in the <span class="quote">packet list</span> panel until you find a packet that contains the summary Info data <span class="quote">ROSCTR: [Job ] Function: [Read Var]</span>( <a href="../images/S7-Basics1.png" target="_blank" title="Graphic showing location of screen element">Example </a>).</li>
  <li><input type="checkbox"> In the<span class="quote"> packet list</span> panel select a packet that contains the summary Info data <span class="quote">ROSCTR: [Job ] Function: [Read Var]</span> ( <a href="../images/S7-Basics1.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> In the middle, <span class="quote">packet details</span>, panel expand the <span class="quote">S7 Communication</span> category then the <span class="quote">Header: (Job) category</span> of decoded data  ( <a href="../images/S7-Basics1.png" target="_blank" title="Graphic showing location of screen element">Example </a>).</li>
  <li><input type="checkbox"> If necessary scroll down the <span class="quote">packet details</span> panel so that all of the decoded <span class="quote">Header: (Job)</span> data is shown ( <a href="../images/S7-Basics1.png" target="_blank">Example</a> ).</li>
  <li><input type="checkbox"> Note the value for the <span class="quote">Protocol Data Unit Reference</span>.
<ul>
      <li>The protocol data unit reference value is used to match data requests with data replies.</li>
    </ul>
  </li>
  <li><input type="checkbox"> Expand the <span class="quote">Parameter: (Read Var)</span> category.</li>
  <li><input type="checkbox"> If necessary scroll down the <span class="quote">packet details</span> panel so that all of the decoded <span class="quote">Parameter: (Read Var)</span> data is shown.</li>
  <li><input type="checkbox"> Note that the first item to be read is a single byte of data from memory area <span class="quote">Q</span> of the PLC ( <a href="../images/S7-Basics2.png" target="_blank">Example</a> ).  
    <ul>
      <li>Memory area <span class="quote">Q</span> is used to store read/write binary data used to turn devices on or off.</li>
      <li>In the cooling system the value at address <span class="quote">Q0.0</span> controls and monitors all power for the cooling system ( <a href="../images/S7-TagAddresses.png" target="_blank">Example</a> ).</li>
      <li>In the cooling system the value at address <span class="quote">Q0.1</span> controls and monitors the pump in the cooling system ( <a href="../images/S7-TagAddresses.png" target="_blank">Example</a> ).      </li>
    </ul>
  </li>
  <li><input type="checkbox"> In the<span class="quote"> packet list</span> panel select a packet that contains the summary Info data <span class="quote">ROSCTR: [Ack_Data ] Function: [Read Var]</span>.</li>
  <li><input type="checkbox"> In the middle, <span class="quote">packet details</span>, panel scroll down if necessary and expand the <span class="quote">Data</span> category.</li>
  <li><input type="checkbox"> If necessary scroll down the <span class="quote">packet details</span> panel so that all of the decoded <span class="quote">Data</span> data is shown.</li>
  <li><input type="checkbox"> Expand the <span class="quote">Item [1]: (Success)</span> category.</li>
  <li><input type="checkbox"> If necessary scroll down the <span class="quote">packet details</span> panel so that all of the decoded <span class="quote">Item [1]: (Success)</span> data is shown.</li>
  <li><input type="checkbox"> Note the hexadecimal value for <span class="quote">Data:</span> ( <a href="../images/S7-AckData.png" target="_blank">Example</a> ).
    <ul>
      <li>Only two bits of data are being used in the byte of data read from the <span class="quote">Q</span> memory area ( <a href="../images/S7-QAreaDecode.png" target="_blank">Example</a> ).
<ul>
          <li>A binary value of 0000 0000 (hexadecimal 00) indicates that both the pump and power to the system is off.          </li>
          <li>A binary value of 0000 0001 (hexadecimal 01) indicates that the pump is off and power to the system is on.</li>
          <li>A binary value of 0000 0010 (hexadecimal 02) indicates that the pump is on and power to the system is off.</li>
          <li>A binary value of 0000 0011 (hexadecimal 03) indicates that both the pump and power to the system is on. </li>
          <li>In the example shown <a href="../images/S7-AckData.png" target="_blank">here</a> the pump is on and power to the system is on.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><input type="checkbox"> View only traffic going to or coming from the OPC server which contains the protocol data unit reference 1909 by clicking in the <span class="quote">display filter</span> field, typing <span class="typed">ip.addr==10.0.255.100 and s7comm.header.pduref==1909</span> then clicking the <span class="button">Apply display filter</span> button or pressing <span class="typed">&lt;ENTER&gt;</span> to activate the filter (<a href="../images/S7-Basics3.png" target="_blank"> Example</a> ).</li>
  <li><input type="checkbox"> Use the data displayed in <span class="quote">Wireshark </span>to answer the last question the lab form found <a href="forms/ics-basics-lab-form.doc">here</a>. </li>
  <li><input type="checkbox"> To end the lab, power off the virtual machines.</li>
</ol>
    </div>
    <br><br><br>
</body>
</html>
